!function(){var e=function(){this.el=document.createElement("div"),this.el.classList.add("wa-mediabox-preloader"),this.wrap=document.createElement("div"),this.wrap.classList.add("wa-mediabox-preloader-wrap"),this.spinner=document.createElement("div"),this.spinner.classList.add("wa-mediabox-preloader-spinner"),this.patch=document.createElement("div"),this.patch.classList.add("wa-mediabox-preloader-patch"),this.clipperLeft=document.createElement("div"),this.clipperLeft.classList.add("wa-mediabox-preloader-clipper"),this.clipperLeft.classList.add("left"),this.clipperRight=document.createElement("div"),this.clipperRight.classList.add("wa-mediabox-preloader-clipper"),this.clipperRight.classList.add("right");var e=document.createElement("div");e.classList.add("wa-mediabox-preloader-circle"),this.patch.appendChild(e),this.clipperLeft.appendChild(e.cloneNode(!0)),this.clipperRight.appendChild(e.cloneNode(!0)),this.spinner.appendChild(this.clipperLeft),this.spinner.appendChild(this.patch),this.spinner.appendChild(this.clipperRight),this.wrap.appendChild(this.spinner),this.el.appendChild(this.wrap)};e.prototype.show=function(){this.el.classList.remove("hidden"),this.el.style.display=""},e.prototype.hide=function(){var e=this;this.el.classList.add("hidden"),setTimeout(function(){e.el.classList.contains("hidden")&&(e.el.style.display="none")},350)};var t=function(e){this.parent=e,this.mediaList=[],this.currentRefreshInterval=null,this.opened=!1,this.loaded=!1,this.current=null,this.containerWidth=null,this.containerHeight=null};t.prototype.addImage=function(e,t,i){return this.mediaList.push({type:"image",src:e,title:t,reloadSec:i}),this.mediaList.length-1},t.prototype.addIframe=function(e,t,i,n){return this.mediaList.push({type:"iframe",src:e,title:t,width:i,height:n}),this.mediaList.length-1},t.prototype.open=function(t){if(!this.opened){var i=this;this.current=-1,this.loaded=!1,this.overlay=document.createElement("div"),this.overlay.classList.add("wa-mediabox-overlay"),this.frame=document.createElement("div"),this.frame.classList.add("wa-mediabox-frame"),this.container=document.createElement("div"),this.container.classList.add("wa-mediabox-container"),this.title=document.createElement("div"),this.title.classList.add("wa-mediabox-title"),this.loading=new e,this.closeBtn=document.createElement("button"),this.closeBtn.classList.add("wa-mediabox-close"),this.closeBtn.innerHTML='<svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>',this.closeBtn.setAttribute("title",this.parent.lang.close),this.prevBtn=document.createElement("button"),this.prevBtn.classList.add("wa-mediabox-prev"),this.prevBtn.innerHTML='<svg viewBox="0 0 24 24"><path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" /></svg>',this.prevBtn.setAttribute("title",this.parent.lang.prev),this.nextBtn=document.createElement("button"),this.nextBtn.classList.add("wa-mediabox-next"),this.nextBtn.innerHTML='<svg viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>',this.nextBtn.setAttribute("title",this.parent.lang.next),this.openBtn=document.createElement("button"),this.openBtn.classList.add("wa-mediabox-open"),this.openBtn.innerHTML='<svg viewBox="0 0 24 24"><path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z" /></svg>',this.openBtn.setAttribute("title",this.parent.lang.openInNew),this.frame.appendChild(this.container),this.frame.appendChild(this.title),this.frame.appendChild(this.loading.el),this.frame.appendChild(this.closeBtn),this.frame.appendChild(this.prevBtn),this.frame.appendChild(this.nextBtn),this.frame.appendChild(this.openBtn),this.overlay.appendChild(this.frame),document.body.appendChild(this.overlay),this.overlay.addEventListener("click",function(e){e.stopPropagation(),i.close()}),this.closeBtn.addEventListener("click",function(e){e.stopPropagation(),i.close()}),this.prevBtn.addEventListener("click",function(e){e.stopPropagation(),i.prev()}),this.nextBtn.addEventListener("click",function(e){e.stopPropagation(),i.next()}),this.container.addEventListener("click",function(e){e.stopPropagation(),i.next()}),this.openBtn.addEventListener("click",function(e){e.stopPropagation(),i.openSource()}),this.resizeHandler=function(){i.resizeContainer()},this.keyDownHandler=function(e){return e.preventDefault(),e.stopPropagation(),37===e.keyCode?i.prev():39===e.keyCode?i.next():27===e.keyCode&&i.close(),!1},window.addEventListener("resize",this.resizeHandler),document.body.addEventListener("keydown",this.keyDownHandler),setTimeout(function(){i.overlay.classList.add("opened"),i.loadMedia(t)},10),this.opened=!0}},t.prototype.close=function(){if(this.opened){var e=this;null!=e.currentRefreshInterval&&(clearInterval(e.currentRefreshInterval),e.currentRefreshInterval=null),this.overlay.classList.remove("opened"),window.removeEventListener("resize",this.resizeHandler),document.body.removeEventListener("keydown",this.keyDownHandler),setTimeout(function(){e.overlay.parentElement.removeChild(e.overlay),e.opened=!1,e.nextBtn=null,e.prevBtn=null,e.closeBtn=null,e.openBtn=null,e.loading=null,e.container=null,e.frame=null,e.overlay=null,e.current=null,e.containerWidth=null,e.containerHeight=null},450)}},t.prototype.resizeContainer=function(){if(this.opened){this.containerWidth||(this.containerWidth=Math.round(.7*this.overlay.offsetWidth)),this.containerHeight||(this.containerHeight=Math.round(.7*this.overlay.offsetWidth));var e=160;this.overlay.offsetWidth<480&&(e=70);var t=Math.min(.9*this.overlay.offsetWidth,this.overlay.offsetWidth-e),i=Math.min(.9*this.overlay.offsetHeight,this.overlay.offsetHeight-64),n=this.containerWidth,a=this.containerHeight,s=n/a;n>t&&(n=Math.round(t),a=n/s),a>i&&(a=Math.round(i),n=a*s),this.frame.style.width=n+"px",this.frame.style.height=a+"px",this.frame.style.marginLeft=-Math.round(n/2)+"px",this.frame.style.marginTop=-Math.round(a/2)+"px"}},t.prototype.setMedia=function(e,t,i,n,a,s,r){if(console.log("setMedia"),this.opened){var o=this;this.loaded=!1,this.frame.classList.remove("can-open-in-new"),o.frame.classList.remove("has-title"),this.container.innerHTML="";var d=null;"image"==t?(a&&(this.containerWidth=a),s&&(this.containerHeight=s),this.resizeContainer(),d=document.createElement("img"),d.addEventListener("load",function(){o.loaded||o.current!=e||(console.log("load current",o.current,e),o.containerWidth=d.width,o.containerHeight=d.height,o.resizeContainer(),o.frame.classList.add("can-open-in-new"),o.container.appendChild(d))}),d.src=i):(a&&(this.containerWidth=a),s&&(this.containerHeight=s+(n?52:0)),this.resizeContainer(),d=document.createElement("iframe"),d.src=i,d.setAttribute("width",parseInt(this.frame.style.width)),d.setAttribute("height",parseInt(this.frame.style.height)-(n?52:0)),d.setAttribute("frameborder","0"),d.setAttribute("allowfullscreen","allowfullscreen"),this.container.appendChild(d)),d.addEventListener("load",function(){o.loaded||o.current!=e||(console.log("load media",d),setTimeout(function(){n&&(o.title.innerHTML=n,o.frame.classList.add("has-title")),o.frame.classList.add("loaded"),o.loading.hide(),o.loaded=!0},550))}),"image"==t&&r&&r>0&&(o.currentRefreshInterval=setInterval(function(){console.log("refresh");var e=(new Date).getTime();if(d.src){var t=i.indexOf("?")>=0?"&myts="+e:"?myts="+e;d.src=i+t}},1e3*r))}},t.prototype.loadMedia=function(e){if(console.log(e),console.log(this.loaded),this.opened&&e!=this.current){var t=this;if(null!=t.currentRefreshInterval&&(clearInterval(t.currentRefreshInterval),t.currentRefreshInterval=null),!this.mediaList[e])throw new Error("Undefined media");var i=function(){t.setMedia(e,t.mediaList[e].type,t.mediaList[e].src,t.mediaList[e].title,t.mediaList[e].width,t.mediaList[e].height,t.mediaList[e].reloadSec)};this.loaded?(this.frame.classList.remove("loaded"),this.loading.show(),setTimeout(i,350)):i(),e>0?this.frame.classList.add("has-prev"):this.frame.classList.remove("has-prev"),e<this.mediaList.length-1?this.frame.classList.add("has-next"):this.frame.classList.remove("has-next"),this.current=e}},t.prototype.prev=function(){if(this.opened){var e=Math.max(0,this.current-1);this.loadMedia(e)}},t.prototype.next=function(){if(this.opened){var e=Math.min(this.mediaList.length-1,this.current+1);this.loadMedia(e)}},t.prototype.openSource=function(){this.opened&&window.open(this.mediaList[this.current].src)};var i=function(){this.lang={prev:"Previous",next:"Next",close:"Close",openInNew:"Open in new window"},this.galleries={}};i.prototype.openGallery=function(e,t){if(!this.galleries[e])throw new Error("Gallery not found");this.galleries[e].open(t)},i.prototype.addImage=function(e,i,n,a){return this.galleries[e]||(this.galleries[e]=new t(this)),this.galleries[e].addImage(i,n,a)},i.prototype.addIframe=function(e,i,n,a,s){return this.galleries[e]||(this.galleries[e]=new t(this)),this.galleries[e].addIframe(i,n,a,s)},i.prototype.bind=function(e,t){if(!e._waMediaBoxBound){e._waMediaBoxBound=!0;var i=this,n=e.getAttribute("data-mediabox")||"_",a=String(e.getAttribute("href")||e.getAttribute("data-src")),s=e.getAttribute("data-title"),r=e.hasAttribute("data-iframe")||a.indexOf("youtube")>=0?!0:!1,o=e.hasAttribute("data-width")?parseInt(e.getAttribute("data-width")):null,d=e.hasAttribute("data-height")?parseInt(e.getAttribute("data-height")):null,l=null;l=r?this.addIframe(n,a,s,o,d):this.addImage(n,a,s,t),e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),i.openGallery(n,l),!1})}},i.prototype.bindAll=function(e,t){for(var i=e.querySelectorAll("a[data-mediabox]"),n=0;n<i.length;n++)this.bind(i.item(n),t)},window.WAMediaBox=new i,window.addEventListener("load",function(){window.WAMediaBox.bindAll(document.body)})}();